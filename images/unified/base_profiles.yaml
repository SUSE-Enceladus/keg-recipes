image:
  profiles:
    _namespace_base_profiles:
      profile:
        # Roles
        - _attributes:
            name: full
            description: KVM and Container host
        - _attributes:
            name: container-host
            description: Container host
        # Platforms
        - _attributes:
            name: x86
            description: Raw disk for x86_64 - uEFI
            arch: x86_64
        - _attributes:
            name: azure-byos
            description: Raw disk for Azure BYOS
        - _attributes:
            name: azure-payg
            description: Raw disk for Azure PAYG
        - _attributes:
            name: ec2-byos
            description: Raw disk for EC2 BYOS
        - _attributes:
            name: ec2-payg
            description: Raw disk for EC2 PAYG
        - _attributes:
            name: gce-byos
            description: Raw disk for GCE BYOS
        - _attributes:
            name: gce-payg
            description: Raw disk for GCE PAYG
  preferences:
    - _include:
        - base/common
    - _attributes:
        profiles: [x86]
      _include:
        - platforms/baremetal/x86
    - _attributes:
        profiles: [azure-byos]
      _include:
        - platforms/csp/azure/byos
    - _attributes:
        profiles: [azure-payg]
        arch: x86_64
      _include:
        - platforms/csp/azure/payg
    - _attributes:
        profiles: [azure-payg]
        arch: aarch64
      _include:
        - platforms/csp/azure/payg
        - platforms/csp/azure/aarch64
    - _attributes:
        profiles: [ec2-byos]
      _include:
        - platforms/csp/ec2/byos
    - _attributes:
        profiles: [ec2-payg]
      _include:
        - platforms/csp/ec2/payg
    - _attributes:
        profiles: [gce-byos]
      _include:
        - platforms/csp/gce/byos
    - _attributes:
        profiles: [gce-payg]
      _include:
        - platforms/csp/gce/payg
  packages:
    - _attributes:
       type: bootstrap
      _include:
        - base/bootstrap
    - _attributes:
        type: image
      _include:
        - base/common
        - products
    - _attributes:
        type: image
        profiles: [full]
      _include:
        - base/kvm_host
    - _attributes:
        type: image
        profiles: [container-host]
      _include:
        - base/container_host
    - _attributes:
        type: image
        profiles: [x86]
      _include:
        - platforms/baremetal/x86
    - _attributes:
        type: image
        profiles: [azure-byos,azure-payg]
      _include:
        - platforms/csp/azure
      archive:
        - _attributes:
            name: azure.tar.gz
    - _attributes:
        type: image
        profiles: [ec2-byos,ec2-payg]
      _include:
        - platforms/csp/ec2
      archive:
        - _attributes:
            name: ec2.tar.gz
    - _attributes:
        type: image
        profiles: [gce-byos,gce-payg]
      _include:
        - platforms/csp/gce
      archive:
        - _attributes:
            name: gce.tar.gz
config:
  - _include:
      - base/common
      - products
  - profiles: [azure-byos,azure-payg]
    _include:
      - platforms/csp/azure
  - profiles: [ec2-byos,ec2-payg]
    _include:
      - platforms/csp/ec2
  - profiles: [gce-byos,gce-payg]
    _include:
      - platforms/csp/gce
archive:
  - name: root.tar.gz
    _include:
      - products
  - name: azure.tar.gz
    _include:
      - platforms/csp/azure
  - name: ec2.tar.gz
    _include:
      - platforms/csp/ec2
  - name: gce.tar.gz
    _include:
      - platforms/csp/gce
